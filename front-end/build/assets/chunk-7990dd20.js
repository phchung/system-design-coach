import{R as g,r as u,j as a,a as z}from"./chunk-7435faac.js";var C={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},M=g.createContext&&g.createContext(C),A=["attr","size","title"];function L(e,t){if(e==null)return{};var r=B(e,t),n,c;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(c=0;c<i.length;c++)n=i[c],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function B(e,t){if(e==null)return{};var r={},n=Object.keys(e),c,i;for(i=0;i<n.length;i++)c=n[i],!(t.indexOf(c)>=0)&&(r[c]=e[c]);return r}function x(){return x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x.apply(this,arguments)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P(Object(r),!0).forEach(function(n){Z(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z(e,t,r){return t=_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e){var t=F(e,"string");return typeof t=="symbol"?t:String(t)}function F(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I(e){return e&&e.map((t,r)=>g.createElement(t.tag,j({key:r},t.attr),I(t.child)))}function b(e){return t=>g.createElement(k,x({attr:j({},e.attr)},t),I(e.child))}function k(e){var t=r=>{var{attr:n,size:c,title:i}=e,d=L(e,A),f=c||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),g.createElement("svg",x({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,d,{className:l,style:j(j({color:e.color||r.color},r.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),i&&g.createElement("title",null,i),e.children)};return M!==void 0?g.createElement(M.Consumer,null,r=>t(r)):t(C)}function W(e){return b({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.82 458.1l-157.8-121.96C488.61 312.13 496 285.01 496 256v-48c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v48c0 17.92-3.96 34.8-10.72 50.2l-26.55-20.52c3.1-9.4 5.28-19.22 5.28-29.67V96c0-53.02-42.98-96-96-96s-96 42.98-96 96v45.36L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.36 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.41-6.97 4.16-17.02-2.82-22.45zM400 464h-56v-33.77c11.66-1.6 22.85-4.54 33.67-8.31l-50.11-38.73c-6.71.4-13.41.87-20.35.2-55.85-5.45-98.74-48.63-111.18-101.85L144 241.31v6.85c0 89.64 63.97 169.55 152 181.69V464h-56c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function G(e){return b({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"},child:[]}]})(e)}function K(e){return b({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function U(e){return b({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M227.79,52.62l-96-32a11.85,11.85,0,0,0-7.58,0l-96,32A12,12,0,0,0,20,63.37,6.05,6.05,0,0,0,20,64v80a12,12,0,0,0,24,0V80.65l23.71,7.9a67.92,67.92,0,0,0,18.42,85A100.36,100.36,0,0,0,46,209.44a12,12,0,1,0,20.1,13.11C80.37,200.59,103,188,128,188s47.63,12.59,61.95,34.55a12,12,0,1,0,20.1-13.11,100.36,100.36,0,0,0-40.18-35.92,67.92,67.92,0,0,0,18.42-85l39.5-13.17a12,12,0,0,0,0-22.76Zm-99.79-8L186.05,64,128,83.35,70,64ZM172,120A44,44,0,1,1,90.94,96.29l33.27,11.09a11.89,11.89,0,0,0,7.58,0l33.27-11.09A43.85,43.85,0,0,1,172,120Z"},child:[]}]})(e)}function N(e){return b({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M192,80v96H104a32,32,0,1,0-32-32H64V80Z",opacity:"0.2"},child:[]},{tag:"path",attr:{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H53.39a8,8,0,0,0,7.23-4.57,48,48,0,0,1,86.76,0,8,8,0,0,0,7.23,4.57H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM80,144a24,24,0,1,1,24,24A24,24,0,0,1,80,144Zm136,56H159.43a64.39,64.39,0,0,0-28.83-26.16,40,40,0,1,0-53.2,0A64.39,64.39,0,0,0,48.57,200H40V56H216ZM56,96V80a8,8,0,0,1,8-8H192a8,8,0,0,1,8,8v96a8,8,0,0,1-8,8H176a8,8,0,0,1,0-16h8V88H72v8a8,8,0,0,1-16,0Z"},child:[]}]})(e)}const $=({initialSystemMessages:e})=>{const[t,r]=u.useState([]),[n,c]=u.useState(""),[i,d]=u.useState(!1),[f,l]=u.useState(!1),[m,y]=u.useState(!1),[T,Q]=u.useState(""),o=new window.webkitSpeechRecognition;o.lang="en-US",o.continuous=!0,o.onresult=s=>{if(s.results[s.resultIndex].isFinal){let h="";const v=s.results[s.resultIndex];h+=v[0].transcript}},o.onerror=s=>{console.error("Speech recognition error:",s.error),console.log(s),o.onend=null,o.stop(),o.abort(),l(!1),y(!1)},o.onabort=s=>{console.error("Speech recognition abort:",s.error),o.onend=null,o.stop(),o.abort(),l(!1),y(!1)},o.onend=()=>{console.log("ON END")};const w=u.useRef(null);u.useEffect(()=>{e.forEach((s,h)=>{setTimeout(()=>{O(s,!0)},h*1e3)})},[e]),u.useEffect(()=>{chrome.runtime.onMessage.addListener(V)},[]);const V=s=>{s.action==="chatGptResponse"&&(y(!1),O(s.response,!0))},O=(s,h)=>{if(h){d(!0),c(s),r(p=>[...p,{content:"",timestamp:Date.now(),isSystemMessage:!0}]);let v=0;const S=setInterval(()=>{r(p=>{const E=p[p.length-1];return E.content===s?(clearInterval(S),d(!1),p):[...p.slice(0,-1),{...E,content:s.substring(0,v+1)}]}),v++,v===s.length&&(clearInterval(S),d(!1))},30)}else r(v=>[...v,{content:s,timestamp:Date.now(),isSystemMessage:!1}])},D=()=>{l(!0),o.onend=()=>{console.log("ON END"),o.start()},console.log("recongition.start"),o.start()},R=()=>{console.log("stop recording"),o.onend=null,o.stop(),l(!1),O(T,!1)};return a.jsxs("div",{id:"overlay",children:[a.jsxs("div",{id:"overlay-content",ref:w,children:[t.map((s,h)=>a.jsxs("div",{className:`message ${s.isSystemMessage?"system-message":"user-message"}`,children:[a.jsx("div",{className:"icon-container",children:s.isSystemMessage?a.jsx(N,{className:"message-icon system-icon"}):a.jsx(U,{className:"message-icon user-icon"})}),a.jsx("div",{className:"message-text",children:s.isSystemMessage?a.jsx(a.Fragment,{children:i&&n===s.content?a.jsx(q,{text:s.content,messagesEndRef:w}):s.content}):s.content})]},h)),a.jsx(a.Fragment,{children:m&&a.jsxs("div",{className:"message system-message",children:[a.jsx("div",{className:"icon-container",children:a.jsx(N,{className:"message-icon system-icon"})}),a.jsx("div",{className:"loader"})]})})]}),a.jsx(a.Fragment,{}),a.jsx("button",{id:"recording-button",onClick:f?R:D,style:{cursor:m?"default":"pointer"},children:f?a.jsx(K,{color:"red"}):m?a.jsx(W,{}):a.jsx(G,{})})]})},q=({text:e,messagesEndRef:t})=>{const[r,n]=u.useState(""),c=u.useRef(null);return u.useEffect(()=>{c.current&&c.current.scrollIntoView({behavior:"smooth"})},[]),u.useEffect(()=>{const i=()=>{if(t.current){const{scrollHeight:l,scrollTop:m,clientHeight:y}=t.current;return l-m!==y}return!0};let d=0;const f=setInterval(()=>{n(l=>{const m=e.substring(0,d+1);return d++,i()&&t.current&&(t.current.scrollTop=t.current.scrollHeight-t.current.clientHeight),m}),d===e.length&&clearInterval(f)},20);return()=>{clearInterval(f)}},[e,t]),a.jsx("div",{ref:c,children:r})};console.info("contentScript is running");const J=["Install"],H=document.createElement("div");document.body.appendChild(H);z.render(g.createElement($,{initialSystemMessages:J}),H);
